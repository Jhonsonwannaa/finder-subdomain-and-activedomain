#!/bin/bash env python3

import concurrent.futures
import requests
import warnings
from colorama import Fore, Style
import sys
import json

warnings.filterwarnings("ignore", message=".*Unverified HTTPS request.*")

'''
Author : jhonson
find sundomains and active subdomains 
'''

try:



 def subdomainfind(url):

  try: 
     
      headers = {'api-key': f'{sys.argv[2]}',
               'accept': 'application/json'}

      r=json.loads(requests.get(url,headers=headers).text) if requests.get(url,headers=headers).status_code==200 else False
      for i in range(0,int(sys.argv[3])):
          save=open('urls.txt','a').write('http://'+str(r[i]['subdomain'])+'\n') 
         
  except IndexError:
      result='Number subdomain'


 def main(url):


  try:

   r=requests.get(url, verify=False).url if requests.get(url,verify=False) else False
  

   save=open('output.txt','a').write(r+'\n')
 
  except requests.exceptions.ConnectionError:
     return False
     

  except requests.exceptions.MissingSchema: 
    return False
  except requests.exceptions.ConnectionError:
    return False

 

 def threads(url):
   
   with concurrent.futures.ThreadPoolExecutor(max_workers=int(sys.argv[4])) as executor:
    futures = [executor.submit(main, url) for url in url]
    for future in concurrent.futures.as_completed(futures):
        print(future.result())
        
        continue


 if __name__ =='__main__':

   urls=f'https://leakix.net/api/subdomains/{sys.argv[1]}'   
   subdomainfind(urls)

 
   with open('urls.txt','r') as file:
     
      url=[files.strip() for files in file.readlines()]
   
   threads(url)

except IndexError:

   print ('python3 activesurl.py urls.txt numberThreads number subdomain')
                                                     
except Exception as e:
    False
